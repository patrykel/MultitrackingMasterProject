# MultitrackingMasterProject

The aim of this code was as follows.
Given .root file with stored tree-like RECO structures - especially with RPRecognizedPatternsCollection - reconstruct track lines for both single and multitracking cases.

Reconstruction was performed only inside so-called Roman Pot groups.
There were 3 groups (Bottom, Horizontal and Top) on the left and the right arm.

The final result was a set of reconstructed tracks (lines in 3D space (x,y,z,dx,dy,dz) where z axis goes along the beam, x points outwards the LHC circle and y points upwards the LHC circle)


## CMSSW

First step is to run code which will download .root file from EOS (there is provided a path to data from 2015 data taking). Then code transform RPRecognizedPatternsCollection into array of records (each record correspond to single silicon strip hit) and store it on EOS in the hard-coded location.

**To do so follow those steps:**
1. Place Demo module from *MultitrackingMasterProject/CMSSW_flat_record_producer/Demo* in your CMSSW framework (the code was tested on CMSSW_7_0_4 from <https://gitlab.cern.ch/totem/totem-offline> )
2. Config where you want to store your records in *MultitrackingMasterProject/blob/master/CMSSW_flat_record_producer/Demo/flat_binary_hit_record_producer.sh*
3. Run *flat_binary_hit_record_producer.sh* 
4. Enjoy! Your records are now transported to EOS. If you are wondering how single record looks like... Feel free to investigate it in: <https://github.com/patrykel/MultitrackingMasterProject/blob/master/multitrackingOOP/binary_reader/bin_reader.py>

## Multitracking algorithm in Python

This algorithm was written using Python 3.6.
Configure your run in <https://github.com/patrykel/MultitrackingMasterProject/blob/master/multitrackingOOP/configuration.py>
Focuse on:
* PATH TO PROJECT - simply what is containing directory of <https://github.com/patrykel/MultitrackingMasterProject/blob/master/multitrackingOOP/main.py>
* GENERAL CONFIGURATION - provide FILL RUN and RECO file for which you want to run reconstruction process.
* SELECT WHAT TO RUN - decide if you would like to reconstruct only tracks for multitracking or single tracking or single tracking with result comparison with TOTEM results.

After configuration is done you simply run:
`python3 main.py`

**REMEMBER** You need to provide:
* RP and silicon geometry in https://github.com/patrykel/MultitrackingMasterProject/tree/master/multitrackingOOP/data/geom
* Hits generated by **CMSSW** module in https://github.com/patrykel/MultitrackingMasterProject/tree/master/multitrackingOOP/data/hits


## SWAN RESULTS

This algorithm was tested on data comming from data taking in 2015. Fills: 4499, 4505, 4509, 4510, 4511.
We analyzed this data sample in <https://github.com/patrykel/MultitrackingMasterProject/blob/master/SWAN_result_graphics/data_analysis/Plotting.ipynb>

We stored results for multitracking in:
<https://github.com/patrykel/MultitrackingMasterProject/tree/master/SWAN_result_graphics/multitracking/stats_png>
And this is a <span style="color:red">**MUST SEE**</span> results for group TOP from left arm:
<https://github.com/patrykel/MultitrackingMasterProject/blob/master/SWAN_result_graphics/multitracking/1_top_heatmaps.ipynb>

We stored also results for single tracking and comparison with TOTEM results in:
<https://github.com/patrykel/MultitrackingMasterProject/tree/master/SWAN_result_graphics/single/plots>

## CONTACT

If you have any questions feel free to contact
